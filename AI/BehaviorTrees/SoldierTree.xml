<BehaviorTree>

	<!--
	=============================================================================================================================================
	SDK_Grunt_03.xml

	Behavior tree that builds on top of the Idle and Combat behaviors from SDK_Grunt_02.xml.
	In addition to that, once losing track of the player, the AI will run to the last known position of the player and play a search animation
	for 10 seconds. Afterwards, it will return to to Idle behavior.
	=============================================================================================================================================
	-->

	<Variables>
		<Variable name="HasTarget"/>

		<!-- these variables are not used in this BT, but need to be present to prevent a warning caused by BasicAI:OnReset() -->
		<Variable name="ExecuteSequence" />
		<Variable name="ExecuteInterruptibleSequence" />
	</Variables>

	<SignalVariables>
		<Signal name="OnNewAttentionTarget" variable="HasTarget" value="true"/>
		<Signal name="OnNoTarget" variable="HasTarget" value="false"/>
		<Signal name="OnLostSightOfTarget" variable="HasTarget" value="false" />
	</SignalVariables>

	<Timestamps>
	</Timestamps>

	<Root>

		<StateMachine>
			

			<!--
			=================================================
					Idle
			=================================================
			-->

			<State name="Idle">

				<Transitions>
					<Transition to="Follow" onEvent="OnNewAttentionTarget"/>
				</Transitions>

				<BehaviorTree>
					<Loop>
						<Sequence>
						
							<Log message="AI in idle state" />
							<SetAlertness value="0"/>

							<ExecuteLua code="entity.actor:HolsterItem(true)"/>

							<Stance name="Relaxed"/>
							
							

							<Halt/>

						</Sequence>
					</Loop>
				</BehaviorTree>

			</State>
			
			<!--
				=====================================
					Follow
				=====================================
			-->
			
			<State name="Follow">
				
				<Transitions>
				
				</Transitions>
				
				<BehaviorTree>
					<Loop>
						<Sequence>
							<SuppressFailure>
								<Move to="Target" />
							</SuppressFailure>
							
							<Log message="KeepTargetAtADistance failed"/>
						</Sequence>
					</Loop>
				</BehaviorTree>
			</State>


		</StateMachine>

	</Root>

</BehaviorTree>
